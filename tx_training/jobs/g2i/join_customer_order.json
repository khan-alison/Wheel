{
  "master": "local",
  "input": [
    {
      "format": "csv",
      "df_name": "customer_df",
      "table": "data/customers.csv",
      "isCache": true,
      "persistentLevel": "MEMORY_ONLY",
      "option": {
        "header": true,
        "inferSchema": true
      }
    },
    {
      "format": "csv",
      "df_name": "orders_df",
      "table": "data/orders.csv",
      "isCache": true,
      "persistentLevel": "MEMORY_ONLY",
      "option": {
        "header": true,
        "inferSchema": true
      }
    }
  ],
  "outputs": {
    "dataframe": "customer_orders",
    "format": "delta",
    "scd": {
      "type": "scd4",
      "path": {
        "current": "data/output/scd4/customers/current",
        "history": "data/output/scd4/customers/history"
      },
      "primary_keys": ["customer_id", "order_id"]
    }
  }
}
